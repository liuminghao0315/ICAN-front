# é«˜æ ¡å†…å®¹åˆ›ä½œè€…è¡Œä¸ºåˆ†æå¹³å° - åç«¯æ¥å£å®Œæ•´æ–‡æ¡£
 
> æœ¬æ–‡æ¡£åŒ…å«åç«¯æ‰€æœ‰æ¥å£ã€æ•°æ®æ¨¡å‹ã€ä¸šåŠ¡æµç¨‹çš„å®Œæ•´è¯´æ˜ï¼Œå‰ç«¯å¼€å‘åªéœ€å‚è€ƒæ­¤æ–‡æ¡£å³å¯ã€‚

---

## ğŸ“‹ ç›®å½•

1. [åŸºç¡€ä¿¡æ¯](#åŸºç¡€ä¿¡æ¯)
2. [è®¤è¯æœºåˆ¶](#è®¤è¯æœºåˆ¶)
3. [ç»Ÿä¸€å“åº”æ ¼å¼](#ç»Ÿä¸€å“åº”æ ¼å¼)
4. [ç”¨æˆ·è®¤è¯æ¨¡å—](#ç”¨æˆ·è®¤è¯æ¨¡å—)
5. [è§†é¢‘ç®¡ç†æ¨¡å—](#è§†é¢‘ç®¡ç†æ¨¡å—)
6. [åˆ†æä»»åŠ¡æ¨¡å—](#åˆ†æä»»åŠ¡æ¨¡å—)
7. [åˆ†æç»“æœæ¨¡å—](#åˆ†æç»“æœæ¨¡å—)
8. [ç»Ÿè®¡æ•°æ®æ¨¡å—](#ç»Ÿè®¡æ•°æ®æ¨¡å—)
9. [WebSocketå®æ—¶é€šçŸ¥](#websocketå®æ—¶é€šçŸ¥)
10. [Mockç®—æ³•æœåŠ¡è¯´æ˜](#mockç®—æ³•æœåŠ¡è¯´æ˜)
11. [æ•°æ®æ¨¡å‹å®šä¹‰](#æ•°æ®æ¨¡å‹å®šä¹‰)
12. [ä¸šåŠ¡æµç¨‹å›¾](#ä¸šåŠ¡æµç¨‹å›¾)
13. [é”™è¯¯ç å¤§å…¨](#é”™è¯¯ç å¤§å…¨)

---

## åŸºç¡€ä¿¡æ¯

| é¡¹ç›® | å€¼ |
|------|-----|
| Base URL | `http://root-springboot3-1:8081` |
| æ•°æ®æ ¼å¼ | JSON |
| å­—ç¬¦ç¼–ç  | UTF-8 |
| Swaggeræ–‡æ¡£ | `http://root-springboot3-1:8081/swagger-ui.html` |

---

## è®¤è¯æœºåˆ¶

### JWT Token

- ç™»å½•æˆåŠŸåè¿”å›JWT Token
- Tokenæœ‰æ•ˆæœŸï¼š5åˆ†é’Ÿï¼ˆå¯é…ç½®ï¼‰
- éœ€è¦è®¤è¯çš„æ¥å£å¿…é¡»åœ¨è¯·æ±‚å¤´æºå¸¦Token

**è¯·æ±‚å¤´æ ¼å¼ï¼š**
```
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

### æ— éœ€è®¤è¯çš„æ¥å£

| è·¯å¾„ | è¯´æ˜ |
|------|------|
| `/auth/**` | ç™»å½•ã€æ³¨å†Œç›¸å…³ |
| `/account/sendMailToResetPwd` | å‘é€é‡ç½®å¯†ç é‚®ä»¶ |
| `/account/resetPwd` | é‡ç½®å¯†ç  |
| `/swagger-ui/**` | Swaggeræ–‡æ¡£ |
| `/v3/api-docs/**` | OpenAPIæ–‡æ¡£ |
| `/ws/**` | WebSocketè¿æ¥ |
| `/api/algorithm/**` | ç®—æ³•æœåŠ¡å›è°ƒ |
| `/test/**` | æµ‹è¯•æ¥å£ |

---

## ç»Ÿä¸€å“åº”æ ¼å¼

æ‰€æœ‰æ¥å£éƒ½è¿”å›ç»Ÿä¸€æ ¼å¼ï¼š

```json
{
  "code": 200,
  "message": "æ“ä½œæˆåŠŸ",
  "data": { ... }
}
```

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| code | Integer | çŠ¶æ€ç ï¼Œ200è¡¨ç¤ºæˆåŠŸ |
| message | String | æç¤ºæ¶ˆæ¯ï¼ŒæˆåŠŸæ—¶å¯èƒ½ä¸ºnull |
| data | Object | å“åº”æ•°æ®ï¼Œç±»å‹æ ¹æ®æ¥å£è€Œå®š |

### åˆ¤æ–­è¯·æ±‚æ˜¯å¦æˆåŠŸ

```javascript
if (response.data.code === 200) {
  // æˆåŠŸ
  const data = response.data.data;
} else {
  // å¤±è´¥
  const errorMsg = response.data.message;
}
```

---

## ç”¨æˆ·è®¤è¯æ¨¡å—

### 1. ç”¨æˆ·ç™»å½•

**POST** `/auth/login`

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "testuser",
  "password": "123456"
}
```

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| username | String | æ˜¯ | ç”¨æˆ·åï¼Œ2-20å­—ç¬¦ |
| password | String | æ˜¯ | å¯†ç ï¼Œ6-20å­—ç¬¦ |

**æˆåŠŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": null,
  "data": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0dXNlciIsImlkIjoiYWJjMTIzIiwiZXhwIjoxNzA1MzI0ODAwfQ.xxxxx"
}
```

**å¤±è´¥å“åº”ï¼š**
```json
{
  "code": 401,
  "message": "ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯",
  "data": null
}
```

**å‰ç«¯å¤„ç†ï¼š**
```javascript
// ç™»å½•æˆåŠŸåä¿å­˜Token
localStorage.setItem('token', response.data.data);

// è®¾ç½®axiosé»˜è®¤è¯·æ±‚å¤´
axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
```

---

### 2. å‘é€æ³¨å†ŒéªŒè¯ç 

**GET** `/auth/sendMailToRegister`

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| mailType | String | æ˜¯ | é‚®ç®±ç±»å‹ï¼šqq / netease |
| mailTo | String | æ˜¯ | æ¥æ”¶é‚®ç®±åœ°å€ |

**è¯·æ±‚ç¤ºä¾‹ï¼š**
```
GET /auth/sendMailToRegister?mailType=qq&mailTo=test@qq.com
```

**æˆåŠŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": null,
  "data": "éªŒè¯ç å‘é€æˆåŠŸ"
}
```

**æ³¨æ„ï¼š** éªŒè¯ç 5åˆ†é’Ÿå†…æœ‰æ•ˆ

---

### 3. ç”¨æˆ·æ³¨å†Œ

**POST** `/auth/register`

**è¯·æ±‚ä½“ï¼š**
```json
{
  "username": "testuser",
  "password": "123456",
  "email": "test@qq.com",
  "verifyCode": "123456"
}
```

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| username | String | æ˜¯ | ç”¨æˆ·åï¼Œ2-20å­—ç¬¦ï¼Œå­—æ¯æ•°å­—ä¸‹åˆ’çº¿ |
| password | String | æ˜¯ | å¯†ç ï¼Œ6-20å­—ç¬¦ |
| email | String | æ˜¯ | é‚®ç®±åœ°å€ |
| verifyCode | String | æ˜¯ | é‚®ç®±éªŒè¯ç  |

**å¯èƒ½çš„é”™è¯¯ç ï¼š**
- `1`: ç”¨æˆ·å·²å­˜åœ¨
- `2`: é‚®ç®±å·²å­˜åœ¨
- `4`: éªŒè¯ç ä¸å­˜åœ¨æˆ–å¤±æ•ˆ

---

### 4. å‘é€é‡ç½®å¯†ç éªŒè¯ç 

**GET** `/account/sendMailToResetPwd`

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| username | String | æ˜¯ | ç”¨æˆ·å |

---

### 5. é‡ç½®å¯†ç 

**GET** `/account/resetPwd`

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| verifyCode | String | æ˜¯ | éªŒè¯ç  |
| newPwd | String | æ˜¯ | æ–°å¯†ç ï¼Œ6-20å­—ç¬¦ |

---

### 6. ç”¨æˆ·ç™»å‡º

**GET** `/account/logout`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**æˆåŠŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": null,
  "data": "ç™»å‡ºæˆåŠŸ"
}
```

---

## è§†é¢‘ç®¡ç†æ¨¡å—

### 1. ç®€å•ä¸Šä¼ ï¼ˆå°æ–‡ä»¶ï¼‰

**POST** `/api/video/upload`

**Content-Type:** `multipart/form-data`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| file | File | æ˜¯ | è§†é¢‘æ–‡ä»¶ï¼ˆå»ºè®®å°äº50MBï¼‰ |
| title | String | å¦ | è§†é¢‘æ ‡é¢˜ï¼Œé»˜è®¤ä¸ºæ–‡ä»¶å |
| description | String | å¦ | è§†é¢‘æè¿° |

**æ”¯æŒçš„è§†é¢‘æ ¼å¼ï¼š** mp4, avi, mov, wmv, flv, mkv, webm, m4v, mpeg, mpg

**æˆåŠŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "ä¸Šä¼ æˆåŠŸ",
  "data": {
    "id": "abc123",
    "title": "æµ‹è¯•è§†é¢‘.mp4",
    "description": null,
    "fileName": "æµ‹è¯•è§†é¢‘.mp4",
    "fileSize": 10485760,
    "fileType": "video/mp4",
    "duration": null,
    "width": null,
    "height": null,
    "thumbnailUrl": null,
    "videoUrl": "http://minio-service:9000/ican-videos/videos/2024/01/15/abc123.mp4",
    "status": "UPLOADED",
    "gmtCreated": "2024-01-15T10:30:00"
  }
}
```

---

### 2. åˆ†ç‰‡ä¸Šä¼  - æ£€æŸ¥çŠ¶æ€

**GET** `/api/video/check-chunk`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| fileIdentifier | String | æ˜¯ | æ–‡ä»¶MD5æ ‡è¯† |
| fileName | String | æ˜¯ | æ–‡ä»¶å |
| totalChunks | Integer | æ˜¯ | æ€»åˆ†ç‰‡æ•° |

**å“åº”ï¼ˆéœ€è¦ç»§ç»­ä¸Šä¼ ï¼‰ï¼š**
```json
{
  "code": 200,
  "data": {
    "needUpload": true,
    "uploadedChunks": [1, 2, 3],
    "finished": false,
    "message": "è¯·ç»§ç»­ä¸Šä¼ æœªå®Œæˆçš„åˆ†ç‰‡"
  }
}
```

**å“åº”ï¼ˆç§’ä¼ æˆåŠŸï¼‰ï¼š**
```json
{
  "code": 200,
  "data": {
    "needUpload": false,
    "finished": true,
    "videoId": "abc123",
    "videoUrl": "http://...",
    "message": "æ–‡ä»¶å·²å­˜åœ¨ï¼Œç§’ä¼ æˆåŠŸ"
  }
}
```

---

### 3. åˆ†ç‰‡ä¸Šä¼  - ä¸Šä¼ åˆ†ç‰‡

**POST** `/api/video/upload-chunk`

**Content-Type:** `multipart/form-data`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| chunk | File | æ˜¯ | åˆ†ç‰‡æ–‡ä»¶ |
| fileIdentifier | String | æ˜¯ | æ–‡ä»¶MD5æ ‡è¯† |
| fileName | String | æ˜¯ | æ–‡ä»¶å |
| chunkNumber | Integer | æ˜¯ | å½“å‰åˆ†ç‰‡åºå·ï¼ˆä»1å¼€å§‹ï¼‰ |
| totalChunks | Integer | æ˜¯ | æ€»åˆ†ç‰‡æ•° |
| chunkSize | Long | æ˜¯ | åˆ†ç‰‡å¤§å° |
| totalSize | Long | æ˜¯ | æ–‡ä»¶æ€»å¤§å° |
| title | String | å¦ | è§†é¢‘æ ‡é¢˜ |
| description | String | å¦ | è§†é¢‘æè¿° |

**å“åº”ï¼ˆä¸Šä¼ å®Œæˆï¼‰ï¼š**
```json
{
  "code": 200,
  "data": {
    "needUpload": false,
    "finished": true,
    "videoId": "abc123",
    "videoUrl": "http://...",
    "message": "æ‰€æœ‰åˆ†ç‰‡ä¸Šä¼ å®Œæˆï¼Œæ–‡ä»¶åˆå¹¶æˆåŠŸ"
  }
}
```

**å‰ç«¯åˆ†ç‰‡ä¸Šä¼ ç¤ºä¾‹ï¼š**
```javascript
const CHUNK_SIZE = 5 * 1024 * 1024; // 5MB

async function uploadLargeFile(file) {
  const totalChunks = Math.ceil(file.size / CHUNK_SIZE);
  const fileIdentifier = await calculateMD5(file); // è®¡ç®—æ–‡ä»¶MD5
  
  // 1. æ£€æŸ¥å·²ä¸Šä¼ çš„åˆ†ç‰‡
  const checkResult = await axios.get('/api/video/check-chunk', {
    params: { fileIdentifier, fileName: file.name, totalChunks }
  });
  
  if (!checkResult.data.data.needUpload) {
    // ç§’ä¼ æˆåŠŸ
    return checkResult.data.data;
  }
  
  const uploadedChunks = checkResult.data.data.uploadedChunks || [];
  
  // 2. ä¸Šä¼ æœªå®Œæˆçš„åˆ†ç‰‡
  for (let i = 1; i <= totalChunks; i++) {
    if (uploadedChunks.includes(i)) continue; // è·³è¿‡å·²ä¸Šä¼ çš„
    
    const start = (i - 1) * CHUNK_SIZE;
    const end = Math.min(start + CHUNK_SIZE, file.size);
    const chunk = file.slice(start, end);
    
    const formData = new FormData();
    formData.append('chunk', chunk);
    formData.append('fileIdentifier', fileIdentifier);
    formData.append('fileName', file.name);
    formData.append('chunkNumber', i);
    formData.append('totalChunks', totalChunks);
    formData.append('chunkSize', chunk.size);
    formData.append('totalSize', file.size);
    
    const result = await axios.post('/api/video/upload-chunk', formData);
    
    if (result.data.data.finished) {
      return result.data.data; // ä¸Šä¼ å®Œæˆ
    }
  }
}
```

---

### 4. è·å–è§†é¢‘è¯¦æƒ…

**GET** `/api/video/{videoId}`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": {
    "id": "abc123",
    "title": "æµ‹è¯•è§†é¢‘",
    "description": "è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•è§†é¢‘",
    "fileName": "test.mp4",
    "fileSize": 10485760,
    "fileType": "video/mp4",
    "duration": 120.5,
    "width": 1920,
    "height": 1080,
    "thumbnailUrl": "http://...",
    "videoUrl": "http://...",
    "status": "COMPLETED",
    "gmtCreated": "2024-01-15T10:30:00"
  }
}
```

**è§†é¢‘çŠ¶æ€è¯´æ˜ï¼š**

| çŠ¶æ€ | è¯´æ˜ |
|------|------|
| UPLOADED | å·²ä¸Šä¼ ï¼Œç­‰å¾…åˆ†æ |
| ANALYZING | åˆ†æä¸­ |
| COMPLETED | åˆ†æå®Œæˆ |
| FAILED | åˆ†æå¤±è´¥ |

---

### 5. è·å–æˆ‘çš„è§†é¢‘åˆ—è¡¨

**GET** `/api/video/list`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| page | int | å¦ | 1 | é¡µç  |
| size | int | å¦ | 10 | æ¯é¡µæ•°é‡ |

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": {
    "records": [
      {
        "id": "abc123",
        "title": "æµ‹è¯•è§†é¢‘",
        "fileName": "test.mp4",
        "fileSize": 10485760,
        "status": "COMPLETED",
        "videoUrl": "http://...",
        "gmtCreated": "2024-01-15T10:30:00"
      }
    ],
    "total": 50,
    "size": 10,
    "current": 1,
    "pages": 5
  }
}
```

---

### 6. åˆ é™¤è§†é¢‘

**DELETE** `/api/video/{videoId}`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**æˆåŠŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "åˆ é™¤æˆåŠŸ",
  "data": null
}
```

---

## åˆ†æä»»åŠ¡æ¨¡å—

### 1. åˆ›å»ºåˆ†æä»»åŠ¡

**POST** `/api/analysis/task`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**è¯·æ±‚ä½“ï¼š**
```json
{
  "videoId": "abc123",
  "taskType": "FULL_ANALYSIS"
}
```

| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| videoId | String | æ˜¯ | è§†é¢‘ID |
| taskType | String | å¦ | ä»»åŠ¡ç±»å‹ï¼Œé»˜è®¤FULL_ANALYSIS |

**ä»»åŠ¡ç±»å‹è¯´æ˜ï¼š**

| ç±»å‹ | è¯´æ˜ |
|------|------|
| FULL_ANALYSIS | å®Œæ•´åˆ†æï¼ˆè§†é¢‘+éŸ³é¢‘+æ–‡æœ¬ï¼‰ |
| VIDEO_ONLY | ä»…è§†é¢‘åˆ†æ |
| AUDIO_ONLY | ä»…éŸ³é¢‘åˆ†æ |
| TEXT_ONLY | ä»…æ–‡æœ¬åˆ†æ |

**æˆåŠŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "ä»»åŠ¡åˆ›å»ºæˆåŠŸ",
  "data": {
    "id": "task123",
    "videoId": "abc123",
    "videoTitle": "æµ‹è¯•è§†é¢‘",
    "videoUrl": "http://...",
    "taskType": "FULL_ANALYSIS",
    "status": "PENDING",
    "progress": 0,
    "errorMessage": null,
    "startedAt": null,
    "completedAt": null,
    "gmtCreated": "2024-01-15T10:30:00",
    "hasResult": false,
    "resultId": null
  }
}
```

**æ³¨æ„ï¼š** åŒä¸€è§†é¢‘ä¸èƒ½åˆ›å»ºå¤šä¸ªåŒæ—¶å¤„ç†çš„ä»»åŠ¡

---

### 2. è·å–ä»»åŠ¡è¯¦æƒ…

**GET** `/api/analysis/task/{taskId}`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": {
    "id": "task123",
    "videoId": "abc123",
    "videoTitle": "æµ‹è¯•è§†é¢‘",
    "videoUrl": "http://...",
    "taskType": "FULL_ANALYSIS",
    "status": "PROCESSING",
    "progress": 60,
    "errorMessage": null,
    "startedAt": "2024-01-15T10:30:05",
    "completedAt": null,
    "gmtCreated": "2024-01-15T10:30:00",
    "hasResult": false,
    "resultId": null
  }
}
```

**ä»»åŠ¡çŠ¶æ€è¯´æ˜ï¼š**

| çŠ¶æ€ | è¯´æ˜ | å‰ç«¯æ˜¾ç¤ºå»ºè®® |
|------|------|-------------|
| PENDING | ç­‰å¾…å¤„ç† | æ˜¾ç¤º"æ’é˜Ÿä¸­" |
| PROCESSING | å¤„ç†ä¸­ | æ˜¾ç¤ºè¿›åº¦æ¡ |
| COMPLETED | å·²å®Œæˆ | æ˜¾ç¤º"æŸ¥çœ‹ç»“æœ"æŒ‰é’® |
| FAILED | å¤±è´¥ | æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯å’Œ"é‡è¯•"æŒ‰é’® |
| CANCELLED | å·²å–æ¶ˆ | æ˜¾ç¤º"å·²å–æ¶ˆ"å’Œ"é‡è¯•"æŒ‰é’® |

---

### 3. è·å–è§†é¢‘çš„æœ€æ–°ä»»åŠ¡

**GET** `/api/analysis/task/video/{videoId}`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š** åŒä»»åŠ¡è¯¦æƒ…

**æ³¨æ„ï¼š** å¦‚æœè§†é¢‘æ²¡æœ‰ä»»åŠ¡ï¼Œdataä¸ºnull

---

### 4. è·å–ä»»åŠ¡åˆ—è¡¨

**GET** `/api/analysis/task/list`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| status | String | å¦ | - | çŠ¶æ€ç­›é€‰ |
| page | int | å¦ | 1 | é¡µç  |
| size | int | å¦ | 10 | æ¯é¡µæ•°é‡ |

---

### 5. å–æ¶ˆä»»åŠ¡

**POST** `/api/analysis/task/{taskId}/cancel`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**æˆåŠŸå“åº”ï¼š**
```json
{
  "code": 200,
  "message": "ä»»åŠ¡å·²å–æ¶ˆ",
  "data": null
}
```

**æ³¨æ„ï¼š** åªèƒ½å–æ¶ˆPENDINGæˆ–PROCESSINGçŠ¶æ€çš„ä»»åŠ¡

---

### 6. é‡è¯•ä»»åŠ¡

**POST** `/api/analysis/task/{taskId}/retry`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**æˆåŠŸå“åº”ï¼š** è¿”å›æ–°åˆ›å»ºçš„ä»»åŠ¡VO

**æ³¨æ„ï¼š** åªèƒ½é‡è¯•FAILEDæˆ–CANCELLEDçŠ¶æ€çš„ä»»åŠ¡

---

## åˆ†æç»“æœæ¨¡å—

### 1. è·å–åˆ†æç»“æœ

**GET** `/api/analysis/result/{resultId}`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": {
    "id": "result123",
    "taskId": "task123",
    "videoId": "abc123",
    "videoTitle": "æµ‹è¯•è§†é¢‘",
    "videoUrl": "http://...",
    
    "riskScore": 0.35,
    "riskLevel": "MEDIUM",
    "riskLevelDesc": "ä¸­é£é™©",
    
    "isUniversityRelated": true,
    "universityName": "æ¸…åå¤§å­¦",
    "universityConfidence": 0.92,
    
    "topicCategory": "æ ¡å›­ç”Ÿæ´»",
    "topicKeywords": ["å¤§å­¦ç”Ÿ", "æ ¡å›­", "é’æ˜¥", "å­¦ä¹ "],
    
    "sentimentScore": 0.45,
    "sentimentLabel": "POSITIVE",
    "sentimentLabelDesc": "æ­£é¢",
    
    "videoFeatures": {
      "duration": 120.5,
      "width": 1920,
      "height": 1080,
      "fps": 30,
      "sceneType": "æ•™å®¤",
      "sceneConfidence": 0.88,
      "faceCount": 3,
      "hasPerson": true,
      "qualityScore": 0.85,
      "brightness": 0.65,
      "clarity": 0.92
    },
    
    "audioFeatures": {
      "hasAudio": true,
      "audioQuality": 0.78,
      "speechRatio": 0.65,
      "musicRatio": 0.15,
      "noiseLevel": 0.12,
      "volumeLevel": 0.68,
      "emotionInVoice": "calm"
    },
    
    "transcription": "å¤§å®¶å¥½ï¼Œä»Šå¤©æˆ‘æ¥åˆ†äº«ä¸€ä¸‹åœ¨å¤§å­¦çš„å­¦ä¹ ç»éªŒ...",
    
    "textFeatures": {
      "titleLength": 10,
      "hasDescription": true,
      "descriptionLength": 50,
      "titleSentiment": 0.3,
      "containsKeywords": true,
      "languageConfidence": 0.98
    },
    
    "audienceAnalysis": {
      "ageDistribution": {
        "18-24": 0.55,
        "25-34": 0.30,
        "35-44": 0.10,
        "45+": 0.05
      },
      "predictedInterests": ["æ•™è‚²", "æ ¡å›­ç”Ÿæ´»", "é’å¹´æ–‡åŒ–"],
      "predictedViews": 5000,
      "predictedEngagement": 0.08
    },
    
    "spreadPotential": 0.72,
    
    "gmtCreated": "2024-01-15T10:31:00"
  }
}
```

**å­—æ®µè¯´æ˜ï¼š**

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| riskScore | Number | ç»¼åˆé£é™©è¯„åˆ†ï¼Œ0-1 |
| riskLevel | String | é£é™©ç­‰çº§ï¼šLOW/MEDIUM/HIGH |
| riskLevelDesc | String | é£é™©ç­‰çº§ä¸­æ–‡æè¿° |
| isUniversityRelated | Boolean | æ˜¯å¦ä¸é«˜æ ¡ç›¸å…³ |
| universityName | String | è¯†åˆ«åˆ°çš„é«˜æ ¡åç§° |
| universityConfidence | Number | é«˜æ ¡è¯†åˆ«ç½®ä¿¡åº¦ï¼Œ0-1 |
| topicCategory | String | ä¸»é¢˜åˆ†ç±» |
| topicKeywords | Array | ä¸»é¢˜å…³é”®è¯åˆ—è¡¨ |
| sentimentScore | Number | æƒ…æ„Ÿè¯„åˆ†ï¼Œ-1åˆ°1 |
| sentimentLabel | String | æƒ…æ„Ÿæ ‡ç­¾ï¼šPOSITIVE/NEUTRAL/NEGATIVE |
| videoFeatures | Object | è§†é¢‘ç‰¹å¾ |
| audioFeatures | Object | éŸ³é¢‘ç‰¹å¾ |
| transcription | String | è¯­éŸ³è½¬æ–‡å­—ç»“æœ |
| textFeatures | Object | æ–‡æœ¬ç‰¹å¾ |
| audienceAnalysis | Object | å—ä¼—åˆ†æ |
| spreadPotential | Number | ä¼ æ’­æ½œåŠ›è¯„åˆ†ï¼Œ0-1 |

---

### 2. æ ¹æ®ä»»åŠ¡IDè·å–ç»“æœ

**GET** `/api/analysis/result/task/{taskId}`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š** åŒä¸Š

**æ³¨æ„ï¼š** å¦‚æœä»»åŠ¡æœªå®Œæˆï¼Œdataä¸ºnull

---

### 3. æ ¹æ®è§†é¢‘IDè·å–æœ€æ–°ç»“æœ

**GET** `/api/analysis/result/video/{videoId}`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š** åŒä¸Š

---

### 4. è·å–ç»“æœåˆ—è¡¨

**GET** `/api/analysis/result/list`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| riskLevel | String | å¦ | - | é£é™©ç­‰çº§ç­›é€‰ï¼šLOW/MEDIUM/HIGH |
| page | int | å¦ | 1 | é¡µç  |
| size | int | å¦ | 10 | æ¯é¡µæ•°é‡ |

---

### 5. è·å–åˆ†æç»Ÿè®¡æ•°æ®

**GET** `/api/analysis/result/stats`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": {
    "totalVideos": 20,
    "analyzedVideos": 15,
    "totalResults": 15,
    "avgRiskScore": 0.35,
    "highRiskCount": 2,
    "mediumRiskCount": 5,
    "lowRiskCount": 8
  }
}
```

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| totalVideos | Number | æ€»è§†é¢‘æ•° |
| analyzedVideos | Number | å·²åˆ†æè§†é¢‘æ•° |
| totalResults | Number | æ€»åˆ†æç»“æœæ•° |
| avgRiskScore | Number | å¹³å‡é£é™©è¯„åˆ† |
| highRiskCount | Number | é«˜é£é™©è§†é¢‘æ•° |
| mediumRiskCount | Number | ä¸­é£é™©è§†é¢‘æ•° |
| lowRiskCount | Number | ä½é£é™©è§†é¢‘æ•° |

---

### 6. è·å–é£é™©åˆ†å¸ƒ

**GET** `/api/analysis/result/risk-distribution`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": {
    "HIGH": 2,
    "MEDIUM": 5,
    "LOW": 8
  }
}
```

---

### 7. åˆ é™¤åˆ†æç»“æœ

**DELETE** `/api/analysis/result/{resultId}`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

---

## ç»Ÿè®¡æ•°æ®æ¨¡å—

### 1. è·å–ä¸Šä¼ è¶‹åŠ¿

**GET** `/api/statistics/upload-trend`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

| å‚æ•° | ç±»å‹ | å¿…å¡« | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| days | int | å¦ | 7 | æŸ¥è¯¢å¤©æ•° |

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": [
    { "date": "2024-01-09", "count": 3, "totalSize": 31457280 },
    { "date": "2024-01-10", "count": 5, "totalSize": 52428800 },
    { "date": "2024-01-11", "count": 2, "totalSize": 20971520 },
    { "date": "2024-01-12", "count": 0, "totalSize": 0 },
    { "date": "2024-01-13", "count": 4, "totalSize": 41943040 },
    { "date": "2024-01-14", "count": 1, "totalSize": 10485760 },
    { "date": "2024-01-15", "count": 3, "totalSize": 31457280 }
  ]
}
```

---

### 2. è·å–æ€»ä½“ç»Ÿè®¡

**GET** `/api/statistics/total`

**éœ€è¦è®¤è¯ï¼š** æ˜¯

**å“åº”ï¼š**
```json
{
  "code": 200,
  "data": {
    "totalUploadCount": 50,
    "totalUploadSize": 524288000,
    "todayUploadCount": 3,
    "todayUploadSize": 31457280
  }
}
```

---

## WebSocketå®æ—¶é€šçŸ¥

### è¿æ¥åœ°å€

```
ws://root-springboot3-1:8081/ws/task-progress/{userId}
```

**å‚æ•°è¯´æ˜ï¼š**
- `userId`: å½“å‰ç™»å½•ç”¨æˆ·çš„ID

**å‰ç«¯è¿æ¥ç¤ºä¾‹ï¼š**
```javascript
// è·å–ç”¨æˆ·IDï¼ˆä»JWT Tokenè§£ææˆ–ä»ç”¨æˆ·ä¿¡æ¯æ¥å£è·å–ï¼‰
const userId = getUserId();

// å»ºç«‹WebSocketè¿æ¥
const ws = new WebSocket(`ws://root-springboot3-1:8081/ws/task-progress/${userId}`);

ws.onopen = () => {
  console.log('WebSocketè¿æ¥æˆåŠŸ');
};

ws.onmessage = (event) => {
  const message = JSON.parse(event.data);
  handleWebSocketMessage(message);
};

ws.onclose = () => {
  console.log('WebSocketè¿æ¥å…³é—­');
  // å¯ä»¥å®ç°è‡ªåŠ¨é‡è¿
};

ws.onerror = (error) => {
  console.error('WebSocketé”™è¯¯:', error);
};

// å‘é€å¿ƒè·³ï¼ˆä¿æŒè¿æ¥ï¼‰
setInterval(() => {
  if (ws.readyState === WebSocket.OPEN) {
    ws.send('ping');
  }
}, 30000);
```

### æ¶ˆæ¯æ ¼å¼

```json
{
  "type": "task_progress",
  "message": "ä»»åŠ¡è¿›åº¦æ›´æ–°",
  "timestamp": 1705294200000,
  "data": { ... }
}
```

### æ¶ˆæ¯ç±»å‹

#### 1. è¿æ¥æˆåŠŸ (connected)

```json
{
  "type": "connected",
  "message": "è¿æ¥æˆåŠŸ",
  "timestamp": 1705294200000
}
```

#### 2. ä»»åŠ¡è¿›åº¦æ›´æ–° (task_progress)

```json
{
  "type": "task_progress",
  "message": "ä»»åŠ¡è¿›åº¦æ›´æ–°",
  "timestamp": 1705294200000,
  "data": {
    "taskId": "task123",
    "status": "PROCESSING",
    "progress": 40,
    "message": "è§†é¢‘ç‰¹å¾æå–"
  }
}
```

**è¿›åº¦é˜¶æ®µè¯´æ˜ï¼š**

| è¿›åº¦ | é˜¶æ®µ |
|------|------|
| 0% | ä»»åŠ¡å¼€å§‹å¤„ç† |
| 20% | è§†é¢‘é¢„å¤„ç† |
| 40% | è§†é¢‘ç‰¹å¾æå– |
| 60% | éŸ³é¢‘åˆ†æ |
| 80% | æ–‡æœ¬åˆ†æ |
| 100% | ç»¼åˆè¯„ä¼°å®Œæˆ |

#### 3. ä»»åŠ¡å®Œæˆ (task_completed)

```json
{
  "type": "task_completed",
  "message": "ä»»åŠ¡å·²å®Œæˆ",
  "timestamp": 1705294200000,
  "data": {
    "taskId": "task123",
    "resultId": "result123"
  }
}
```

**å‰ç«¯å¤„ç†ï¼š** æ”¶åˆ°æ­¤æ¶ˆæ¯åå¯ä»¥è·³è½¬åˆ°ç»“æœé¡µé¢æˆ–åˆ·æ–°ä»»åŠ¡çŠ¶æ€

#### 4. ä»»åŠ¡å¤±è´¥ (task_failed)

```json
{
  "type": "task_failed",
  "message": "ä»»åŠ¡å¤±è´¥",
  "timestamp": 1705294200000,
  "data": {
    "taskId": "task123",
    "errorMessage": "è§†é¢‘æ ¼å¼ä¸æ”¯æŒ"
  }
}
```

### å¿ƒè·³æœºåˆ¶

- å‘é€ï¼š`ping`
- å“åº”ï¼š`pong`

### å‰ç«¯æ¶ˆæ¯å¤„ç†ç¤ºä¾‹

```javascript
function handleWebSocketMessage(message) {
  switch (message.type) {
    case 'connected':
      console.log('WebSocketè¿æ¥æˆåŠŸ');
      break;
      
    case 'task_progress':
      // æ›´æ–°ä»»åŠ¡è¿›åº¦æ¡
      updateTaskProgress(message.data.taskId, message.data.progress, message.data.message);
      break;
      
    case 'task_completed':
      // ä»»åŠ¡å®Œæˆï¼Œæ˜¾ç¤ºé€šçŸ¥å¹¶æ›´æ–°UI
      showNotification('ä»»åŠ¡å®Œæˆ', 'åˆ†æå·²å®Œæˆï¼Œç‚¹å‡»æŸ¥çœ‹ç»“æœ');
      refreshTaskStatus(message.data.taskId);
      break;
      
    case 'task_failed':
      // ä»»åŠ¡å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
      showError('ä»»åŠ¡å¤±è´¥', message.data.errorMessage);
      refreshTaskStatus(message.data.taskId);
      break;
  }
}
```

---

## Mockç®—æ³•æœåŠ¡è¯´æ˜

### å·¥ä½œåŸç†

Mockç®—æ³•æœåŠ¡ç”¨äºæ¨¡æ‹ŸçœŸå®çš„è§†é¢‘åˆ†æç®—æ³•ï¼Œæ–¹ä¾¿å‰ç«¯å¼€å‘å’Œæµ‹è¯•ã€‚

**å·¥ä½œæµç¨‹ï¼š**

1. ç”¨æˆ·åˆ›å»ºåˆ†æä»»åŠ¡åï¼Œä»»åŠ¡çŠ¶æ€ä¸º `PENDING`
2. MockæœåŠ¡è‡ªåŠ¨æ£€æµ‹åˆ°å¾…å¤„ç†ä»»åŠ¡
3. MockæœåŠ¡å°†ä»»åŠ¡çŠ¶æ€æ”¹ä¸º `PROCESSING`ï¼Œå¼€å§‹æ¨¡æ‹Ÿåˆ†æ
4. åˆ†5ä¸ªé˜¶æ®µæ›´æ–°è¿›åº¦ï¼ˆæ¯ä¸ªé˜¶æ®µçº¦1-6ç§’ï¼‰
5. ç”Ÿæˆæ¨¡æ‹Ÿåˆ†æç»“æœå¹¶ä¿å­˜
6. å°†ä»»åŠ¡çŠ¶æ€æ”¹ä¸º `COMPLETED`
7. å…¨ç¨‹é€šè¿‡WebSocketæ¨é€è¿›åº¦

### å¤„ç†æ—¶é—´

- åŸºç¡€æ—¶é—´ï¼š5ç§’
- é¢å¤–æ—¶é—´ï¼šæ ¹æ®è§†é¢‘å¤§å°ï¼Œæ¯MBçº¦å¢åŠ 0.5ç§’
- æ€»æ—¶é—´èŒƒå›´ï¼š5-30ç§’

### æ¨¡æ‹Ÿæ•°æ®ç‰¹ç‚¹

| æ•°æ® | ç”Ÿæˆæ–¹å¼ |
|------|----------|
| é£é™©è¯„åˆ† | æ­£æ€åˆ†å¸ƒï¼Œå‡å€¼0.3ï¼Œå¤§å¤šæ•°è§†é¢‘ä¸ºä½é£é™© |
| é£é™©ç­‰çº§ | 0-0.3ä¸ºLOWï¼Œ0.3-0.7ä¸ºMEDIUMï¼Œ0.7-1.0ä¸ºHIGH |
| é«˜æ ¡è¯†åˆ« | 70%æ¦‚ç‡è¯†åˆ«ä¸ºé«˜æ ¡ç›¸å…³ |
| é«˜æ ¡åç§° | ä»é¢„è®¾çš„15æ‰€é«˜æ ¡ä¸­éšæœºé€‰æ‹© |
| ä¸»é¢˜åˆ†ç±» | ä»10ä¸ªé¢„è®¾åˆ†ç±»ä¸­éšæœºé€‰æ‹© |
| å…³é”®è¯ | ä»24ä¸ªé¢„è®¾å…³é”®è¯ä¸­éšæœºé€‰æ‹©3-7ä¸ª |
| æƒ…æ„Ÿåˆ†æ | éšæœºç”Ÿæˆ-1åˆ°1çš„åˆ†æ•° |

### æµ‹è¯•å»ºè®®

1. ä¸Šä¼ ä¸€ä¸ªè§†é¢‘
2. åˆ›å»ºåˆ†æä»»åŠ¡
3. è§‚å¯ŸWebSocketè¿›åº¦æ¨é€
4. ç­‰å¾…ä»»åŠ¡å®ŒæˆåæŸ¥çœ‹ç»“æœ

---

## æ•°æ®æ¨¡å‹å®šä¹‰

### ç”¨æˆ· (User)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | String(36) | ç”¨æˆ·IDï¼ˆUUIDï¼‰ |
| name | String(50) | ç”¨æˆ·å |
| password | String(255) | å¯†ç ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰ |
| email | String(100) | é‚®ç®± |
| gmtCreated | DateTime | åˆ›å»ºæ—¶é—´ |
| gmtModified | DateTime | ä¿®æ”¹æ—¶é—´ |

### è§†é¢‘ (Video)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | String(36) | è§†é¢‘ID |
| userId | String(36) | ä¸Šä¼ ç”¨æˆ·ID |
| title | String(200) | è§†é¢‘æ ‡é¢˜ |
| description | Text | è§†é¢‘æè¿° |
| fileName | String(255) | åŸå§‹æ–‡ä»¶å |
| filePath | String(500) | MinIOå­˜å‚¨è·¯å¾„ |
| fileSize | Long | æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| fileType | String(50) | æ–‡ä»¶ç±»å‹ |
| duration | Double | è§†é¢‘æ—¶é•¿ï¼ˆç§’ï¼‰ |
| width | Integer | è§†é¢‘å®½åº¦ |
| height | Integer | è§†é¢‘é«˜åº¦ |
| thumbnailPath | String(500) | ç¼©ç•¥å›¾è·¯å¾„ |
| status | String(20) | çŠ¶æ€ |
| gmtCreated | DateTime | åˆ›å»ºæ—¶é—´ |
| gmtModified | DateTime | ä¿®æ”¹æ—¶é—´ |

### åˆ†æä»»åŠ¡ (AnalysisTask)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | String(36) | ä»»åŠ¡ID |
| videoId | String(36) | å…³è”è§†é¢‘ID |
| userId | String(36) | åˆ›å»ºç”¨æˆ·ID |
| taskType | String(50) | ä»»åŠ¡ç±»å‹ |
| status | String(20) | ä»»åŠ¡çŠ¶æ€ |
| progress | Integer | å¤„ç†è¿›åº¦(0-100) |
| errorMessage | Text | é”™è¯¯ä¿¡æ¯ |
| startedAt | DateTime | å¼€å§‹å¤„ç†æ—¶é—´ |
| completedAt | DateTime | å®Œæˆæ—¶é—´ |
| gmtCreated | DateTime | åˆ›å»ºæ—¶é—´ |
| gmtModified | DateTime | ä¿®æ”¹æ—¶é—´ |

### åˆ†æç»“æœ (AnalysisResult)

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | String(36) | ç»“æœID |
| taskId | String(36) | å…³è”ä»»åŠ¡ID |
| videoId | String(36) | å…³è”è§†é¢‘ID |
| riskScore | Decimal(5,4) | ç»¼åˆé£é™©è¯„åˆ† |
| riskLevel | String(20) | é£é™©ç­‰çº§ |
| isUniversityRelated | Boolean | æ˜¯å¦é«˜æ ¡ç›¸å…³ |
| universityName | String(100) | é«˜æ ¡åç§° |
| universityConfidence | Decimal(5,4) | é«˜æ ¡è¯†åˆ«ç½®ä¿¡åº¦ |
| topicCategory | String(50) | ä¸»é¢˜åˆ†ç±» |
| topicKeywords | JSON | ä¸»é¢˜å…³é”®è¯ |
| sentimentScore | Decimal(5,4) | æƒ…æ„Ÿè¯„åˆ† |
| sentimentLabel | String(20) | æƒ…æ„Ÿæ ‡ç­¾ |
| videoFeatures | JSON | è§†é¢‘ç‰¹å¾ |
| audioFeatures | JSON | éŸ³é¢‘ç‰¹å¾ |
| transcription | Text | è¯­éŸ³è½¬æ–‡å­— |
| textFeatures | JSON | æ–‡æœ¬ç‰¹å¾ |
| audienceAnalysis | JSON | å—ä¼—åˆ†æ |
| spreadPotential | Decimal(5,4) | ä¼ æ’­æ½œåŠ› |
| gmtCreated | DateTime | åˆ›å»ºæ—¶é—´ |
| gmtModified | DateTime | ä¿®æ”¹æ—¶é—´ |

---

## ä¸šåŠ¡æµç¨‹å›¾

### å®Œæ•´åˆ†ææµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ç”¨æˆ·æ“ä½œæµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ç™»å½• â”‚ â”€â”€â–º â”‚ ä¸Šä¼ è§†é¢‘ â”‚ â”€â”€â–º â”‚ åˆ›å»ºä»»åŠ¡ â”‚ â”€â”€â–º â”‚ æŸ¥çœ‹ç»“æœ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                    â”‚                â”‚                â”‚          â”‚
â”‚                    â–¼                â–¼                â–¼          â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚              â”‚ MinIO    â”‚    â”‚ ä»»åŠ¡é˜Ÿåˆ—  â”‚    â”‚ åˆ†æç»“æœ â”‚     â”‚
â”‚              â”‚ å­˜å‚¨     â”‚    â”‚           â”‚    â”‚ å±•ç¤º     â”‚     â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                   â”‚                            â”‚
â”‚                                   â–¼                            â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                            â”‚ Mockç®—æ³•  â”‚                       â”‚
â”‚                            â”‚ æœåŠ¡å¤„ç†  â”‚                       â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                   â”‚                            â”‚
â”‚                                   â–¼                            â”‚
â”‚                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                            â”‚ WebSocket â”‚                       â”‚
â”‚                            â”‚ å®æ—¶é€šçŸ¥  â”‚                       â”‚
â”‚                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è§†é¢‘ä¸Šä¼ æµç¨‹

```
å¼€å§‹
  â”‚
  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ£€æŸ¥æ–‡ä»¶æ ¼å¼æ˜¯å¦  â”‚
â”‚ æ”¯æŒï¼ˆmp4ç­‰ï¼‰     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
    â”‚   æ˜¯å¦    â”‚
    â”‚ å¤§äº50MB  â”‚
    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
          â”‚
    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
   å¦           æ˜¯
    â”‚           â”‚
    â–¼           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ç®€å•ä¸Šä¼ â”‚  â”‚ è®¡ç®—MD5    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚
     â”‚            â–¼
     â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚      â”‚ æ£€æŸ¥åˆ†ç‰‡  â”‚
     â”‚      â”‚ ä¸Šä¼ çŠ¶æ€  â”‚
     â”‚      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚
     â”‚      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     â”‚      â”‚ æ˜¯å¦å·²å­˜åœ¨ â”‚
     â”‚      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚
     â”‚      â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”
     â”‚     æ˜¯           å¦
     â”‚      â”‚           â”‚
     â”‚      â–¼           â–¼
     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  â”‚ ç§’ä¼    â”‚  â”‚ åˆ†ç‰‡ä¸Šä¼    â”‚
     â”‚  â”‚ æˆåŠŸ   â”‚  â”‚ æœªå®Œæˆåˆ†ç‰‡ â”‚
     â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚            â”‚
     â”‚       â”‚            â–¼
     â”‚       â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚       â”‚      â”‚ è‡ªåŠ¨åˆå¹¶  â”‚
     â”‚       â”‚      â”‚ æ‰€æœ‰åˆ†ç‰‡  â”‚
     â”‚       â”‚      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚       â”‚            â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ ä¿å­˜åˆ°MinIO   â”‚
            â”‚ åˆ›å»ºè§†é¢‘è®°å½•  â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
                  ç»“æŸ
```

### åˆ†æä»»åŠ¡æµç¨‹

```
åˆ›å»ºä»»åŠ¡
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ çŠ¶æ€: PENDING   â”‚
â”‚ è¿›åº¦: 0%        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MockæœåŠ¡æ£€æµ‹åˆ°  â”‚ â”€â”€â”€â–º â”‚ çŠ¶æ€: PROCESSINGâ”‚
â”‚ å¾…å¤„ç†ä»»åŠ¡      â”‚      â”‚ è¿›åº¦: 0%        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                        â”‚                        â”‚
         â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ è§†é¢‘é¢„å¤„ç†      â”‚      â”‚ è§†é¢‘ç‰¹å¾æå–    â”‚      â”‚ éŸ³é¢‘åˆ†æ        â”‚
â”‚ è¿›åº¦: 20%       â”‚ â”€â”€â”€â–º â”‚ è¿›åº¦: 40%       â”‚ â”€â”€â”€â–º â”‚ è¿›åº¦: 60%       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                           â”‚
                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                        â”‚                        â”‚
         â–¼                        â–¼                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–‡æœ¬åˆ†æ        â”‚      â”‚ ç»¼åˆè¯„ä¼°        â”‚      â”‚ ä¿å­˜ç»“æœ        â”‚
â”‚ è¿›åº¦: 80%       â”‚ â”€â”€â”€â–º â”‚ è¿›åº¦: 100%      â”‚ â”€â”€â”€â–º â”‚ çŠ¶æ€: COMPLETED â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                           â”‚
                                                           â–¼
                                                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                  â”‚ WebSocketé€šçŸ¥   â”‚
                                                  â”‚ ä»»åŠ¡å®Œæˆ        â”‚
                                                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## é”™è¯¯ç å¤§å…¨

| é”™è¯¯ç  | è¯´æ˜ | å¤„ç†å»ºè®® |
|--------|------|----------|
| 200 | æˆåŠŸ | - |
| 1 | ç”¨æˆ·å·²å­˜åœ¨ | æç¤ºç”¨æˆ·æ›´æ¢ç”¨æˆ·å |
| 2 | é‚®ç®±å·²å­˜åœ¨ | æç¤ºç”¨æˆ·æ›´æ¢é‚®ç®±æˆ–æ‰¾å›å¯†ç  |
| 3 | é‚®ç®±ç±»å‹ä¸æ”¯æŒ | æç¤ºåªæ”¯æŒQQå’Œç½‘æ˜“é‚®ç®± |
| 4 | éªŒè¯ç ä¸å­˜åœ¨æˆ–å¤±æ•ˆ | æç¤ºé‡æ–°å‘é€éªŒè¯ç  |
| 5 | ç”¨æˆ·ä¸å­˜åœ¨ | æç¤ºæ£€æŸ¥ç”¨æˆ·åæˆ–æ³¨å†Œ |
| 6 | æ–°æ—§å¯†ç ç›¸åŒ | æç¤ºè¾“å…¥ä¸åŒçš„æ–°å¯†ç  |
| 400 | å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•° |
| 401 | è®¤è¯å¤±è´¥ | é‡æ–°ç™»å½• |
| 403 | æƒé™ä¸è¶³ | æç¤ºæ— æƒæ“ä½œ |
| 404 | èµ„æºä¸å­˜åœ¨ | æç¤ºèµ„æºä¸å­˜åœ¨ |
| 405 | æ–¹æ³•ä¸æ”¯æŒ | æ£€æŸ¥è¯·æ±‚æ–¹æ³• |
| 500 | ç³»ç»Ÿé”™è¯¯ | æç¤ºç¨åé‡è¯• |

---

## å‰ç«¯å¼€å‘å»ºè®®

### 1. Axioså°è£…

```javascript
import axios from 'axios';

const api = axios.create({
  baseURL: 'http://root-springboot3-1:8081',
  timeout: 30000
});

// è¯·æ±‚æ‹¦æˆªå™¨ - æ·»åŠ Token
api.interceptors.request.use(config => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});

// å“åº”æ‹¦æˆªå™¨ - ç»Ÿä¸€å¤„ç†
api.interceptors.response.use(
  response => {
    if (response.data.code === 200) {
      return response.data;
    } else {
      return Promise.reject(response.data);
    }
  },
  error => {
    if (error.response?.status === 401) {
      // Tokenè¿‡æœŸï¼Œè·³è½¬ç™»å½•
      localStorage.removeItem('token');
      window.location.href = '/login';
    }
    return Promise.reject(error);
  }
);

export default api;
```

### 2. æ¨èçš„é¡µé¢ç»“æ„

```
/login          - ç™»å½•é¡µ
/register       - æ³¨å†Œé¡µ
/dashboard      - å·¥ä½œå°ï¼ˆç»Ÿè®¡æ¦‚è§ˆï¼‰
/videos         - è§†é¢‘åˆ—è¡¨
/videos/upload  - è§†é¢‘ä¸Šä¼ 
/videos/:id     - è§†é¢‘è¯¦æƒ…
/tasks          - ä»»åŠ¡åˆ—è¡¨
/tasks/:id      - ä»»åŠ¡è¯¦æƒ…
/results        - åˆ†æç»“æœåˆ—è¡¨
/results/:id    - åˆ†æç»“æœè¯¦æƒ…
```

### 3. æ•°æ®åˆ·æ–°ç­–ç•¥

| åœºæ™¯ | ç­–ç•¥ |
|------|------|
| ä»»åŠ¡è¿›åº¦ | WebSocketå®æ—¶æ¨é€ |
| è§†é¢‘åˆ—è¡¨ | ä¸Šä¼ /åˆ é™¤ååˆ·æ–° |
| ç»“æœåˆ—è¡¨ | ä»»åŠ¡å®Œæˆé€šçŸ¥ååˆ·æ–° |
| ç»Ÿè®¡æ•°æ® | è¿›å…¥é¡µé¢æ—¶åŠ è½½ |

---

## æ›´æ–°æ—¥å¿—

- **v1.0** - åˆå§‹ç‰ˆæœ¬
  - ç”¨æˆ·è®¤è¯æ¨¡å—
  - è§†é¢‘ç®¡ç†æ¨¡å—
  - åˆ†æä»»åŠ¡æ¨¡å—
  - åˆ†æç»“æœæ¨¡å—
  - WebSocketå®æ—¶é€šçŸ¥
  - Mockç®—æ³•æœåŠ¡

